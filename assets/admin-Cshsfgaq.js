import{c as ae,u as W,r as b,j as e}from"./vendor-TSQaGVAF.js";const J="https://pvcqsfrxxncafvvsutvr.supabase.co",F="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB2Y3FzZnJ4eG5jYWZ2dnN1dHZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczNDkxOTQsImV4cCI6MjA2MjkyNTE5NH0.cmZYoSG7UUsrUAsyNCsHcUhyIL9OHSelveGXH06Hm64";let _={isOnline:!0,lastChecked:null,retryCount:0,maxRetries:3};const v=()=>(console.warn("[Supabase] Membuat dummy client"),{supabaseUrl:J,supabaseKey:F,from:d=>(console.log(`[Supabase Dummy] Mengakses tabel ${d}`),{select:n=>(console.log(`[Supabase Dummy] Select ${n||"*"} dari ${d}`),{eq:(o,c)=>(console.log(`[Supabase Dummy] Where ${o} = ${c}`),{single:()=>({data:null,error:new Error("Dummy client")}),data:null,error:new Error("Dummy client")}),limit:o=>(console.log(`[Supabase Dummy] Limit ${o}`),{data:[],error:null}),single:()=>({data:null,error:new Error("Dummy client")})}),update:n=>(console.log(`[Supabase Dummy] Update ${d} dengan`,n),{eq:(o,c)=>(console.log(`[Supabase Dummy] Where ${o} = ${c}`),{select:()=>({single:()=>({data:{...n,id:c},error:null})}),data:{...n,id:c},error:null})}),insert:n=>(console.log(`[Supabase Dummy] Insert ke ${d}`,n),{data:Array.isArray(n)?n:[n],error:null})}),auth:{getSession:async()=>({data:{session:null},error:null}),getUser:async()=>({data:{user:null},error:null}),signOut:async()=>({error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},rpc:(d,n)=>(console.log(`[Supabase Dummy] RPC call ${d} dengan`,n),{data:null,error:null}),isOnline:()=>!1,testConnection:async()=>!0}),ne=()=>{try{console.log("[Supabase] Mencoba membuat client...");const d=ae(J,F,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"},global:{headers:{"Content-Type":"application/json"}},realtime:{enabled:!0}});if(!d)return console.error("[Supabase] Client tidak berhasil dibuat"),v();if(typeof d.from!="function")if(console.error("[Supabase] Client tidak memiliki metode from yang valid"),d.from&&typeof d.from=="function"){console.log("[Supabase] Metode from ditemukan dengan cara alternatif");const o={...d,from:d.from.bind(d)};try{const c=o.from("siswa");if(c&&typeof c.select=="function")console.log("[Supabase] Metode from berhasil diperbaiki"),d.from=o.from;else return console.error("[Supabase] Metode from yang diperbaiki tidak berfungsi"),v()}catch(c){return console.error("[Supabase] Error saat memperbaiki metode from:",c),v()}}else return console.error("[Supabase] Metode from tidak ditemukan sama sekali"),v();try{const o=d.from("siswa");if(!o||typeof o.select!="function")return console.error("[Supabase] Metode from tidak mengembalikan objek yang valid"),v();const c=o.select("*");if(!c||typeof c.eq!="function")return console.error("[Supabase] Metode select tidak mengembalikan objek yang valid"),v();console.log("[Supabase] Semua metode chain berhasil diuji")}catch(o){return console.error("[Supabase] Error saat menguji metode from:",o),v()}console.log("[Supabase] Client berhasil dibuat dengan metode from yang valid");const n={...d,supabaseUrl:J,supabaseKey:F,isOnline:()=>_.isOnline,checkConnection:async()=>{try{return await n.testConnection()}catch(o){return console.error("[Supabase] Error saat memeriksa koneksi:",o.message),_={..._,isOnline:!1,lastChecked:Date.now(),retryCount:_.retryCount+1},!1}},testConnection:async(o=3e3)=>{try{const c=Date.now(),j=new Promise((N,S)=>{setTimeout(()=>S(new Error("Connection timeout")),o)}),p=d.auth.getSession();await Promise.race([p,j]);const x=Date.now()-c;return console.log(`[Supabase] Response time: ${x}ms`),_={..._,isOnline:!0,lastChecked:Date.now()},!0}catch(c){return console.error("[Supabase] Connection test failed:",c.message),_={..._,isOnline:!1,lastChecked:Date.now()},!1}},retryOperation:async(o,c=3,j=1e3)=>{let p=0;for(;p<c;)try{return await o()}catch(x){if(p++,p>=c)throw x;console.log(`[Supabase] Retry ${p}/${c} after ${j}ms`),await new Promise(N=>setTimeout(N,j)),j*=2}},from:function(o){return typeof d.from=="function"?d.from(o):(console.error("[Supabase] Metode from tidak tersedia, menggunakan dummy"),v().from(o))},debug:()=>{console.log("[Supabase] Available methods on client:",Object.keys(d));try{const o=d.from("siswa");console.log("[Supabase] Available methods on from:",Object.keys(o))}catch(o){console.error("[Supabase] Error saat debug metode from:",o)}return{client:d,connectionStatus:_}}};return n.checkConnection().catch(o=>{console.error("[Supabase] Initial connection check failed:",o),_.isOnline=!1}),n}catch(d){return console.error("[Supabase] Error membuat client:",d),v()}};console.log("[Supabase] Memulai inisialisasi client...");const h=ne();h||console.error("[Supabase] Failed to initialize client, menggunakan dummy client");h&&h.auth;const re=()=>{const d=W(),[n,o]=b.useState({nama:"",nomorInduk:"",role:"4",kelas:"",noTelp:"",password:"",tanggalLahir:"",alamat:"",jenisKelamin:"L"}),[c,j]=b.useState(!1),[p,x]=b.useState({text:"",type:""}),N={1:"admin",2:"guru",3:"orang tua",4:"siswa"},S=l=>l==="2"||l==="4",k=l=>{const{name:f,value:T}=l.target;o({...n,[f]:T})},K=async l=>{l.preventDefault(),j(!0),x({text:"",type:""});try{if(!n.nama||!n.nomorInduk){x({text:"Nama dan nomor induk harus diisi",type:"error"}),j(!1);return}if(S(n.role)&&!n.kelas){const w=n.role==="4"?"siswa":"guru";x({text:`Kelas harus diisi untuk ${w}`,type:"error"}),j(!1);return}if(n.role==="4"&&(!n.tanggalLahir||!n.jenisKelamin)){x({text:"Tanggal lahir dan jenis kelamin harus diisi untuk siswa",type:"error"}),j(!1);return}if(n.role==="2"&&!n.noTelp){x({text:"Nomor telepon harus diisi untuk guru",type:"error"}),j(!1);return}if(!n.password){x({text:"Password harus diisi",type:"error"}),j(!1);return}let f;const T=N[n.role]||"pengguna";if(n.role==="4"){const w={nis:n.nomorInduk,nama:n.nama,id_kelas:parseInt(n.kelas),id_role:parseInt(n.role),password:n.password,tanggal_lahir:n.tanggalLahir||null,alamat:n.alamat||null,Jenis_Kelamin:n.jenisKelamin==="P"?"perempuan":"laki"};f=(await h.from("siswa").insert(w)).error}else if(n.role==="2"){const w={nuptk:n.nomorInduk,nama:n.nama,no_telp:n.noTelp,id_role:parseInt(n.role),password:n.password,kelas:parseInt(n.kelas),alamat:n.alamat||null};f=(await h.from("guru").insert(w)).error}else if(n.role==="3"){const w={nama:n.nama,no_telp:n.noTelp,id_role:parseInt(n.role),password:n.password,alamat:n.alamat||null};f=(await h.from("wali").insert(w)).error}if(f)throw f;x({text:`Akun ${T} berhasil dibuat untuk ${n.nama}`,type:"success"}),o({nama:"",nomorInduk:"",role:"4",kelas:"",noTelp:"",password:"",tanggalLahir:"",alamat:"",jenisKelamin:"L"})}catch(f){console.error("Error creating user:",f),x({text:`Error: ${f.message||"Terjadi kesalahan saat membuat akun"}`,type:"error"})}finally{j(!1)}};return e.jsx("div",{className:"login-container admin-register",children:e.jsxs("div",{className:"login-card",children:[e.jsx("h2",{children:"Admin - Registrasi Pengguna Baru"}),p.text&&e.jsx("div",{className:`message ${p.type}`,children:p.text}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"role",children:"Jenis Pengguna"}),e.jsxs("select",{id:"role",name:"role",value:n.role,onChange:k,required:!0,children:[e.jsx("option",{value:"4",children:"Siswa"}),e.jsx("option",{value:"2",children:"Guru"}),e.jsx("option",{value:"3",children:"Orang Tua"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nama",children:"Nama Lengkap"}),e.jsx("input",{type:"text",id:"nama",name:"nama",value:n.nama,onChange:k,required:!0})]}),"          ",e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nomorInduk",children:n.role==="4"?"NIS":n.role==="2"?"NUPTK":"Nomor Induk"}),e.jsx("input",{type:"text",id:"nomorInduk",name:"nomorInduk",value:n.nomorInduk,onChange:k,required:!0})]}),(n.role==="2"||n.role==="3")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"noTelp",children:"Nomor Telepon"}),e.jsx("input",{type:"tel",id:"noTelp",name:"noTelp",value:n.noTelp,onChange:k,required:n.role==="2",placeholder:"Format: 08xxxxxxxxxx"})]}),"          ",e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n.password,onChange:k,required:!0})]}),"          ",S(n.role)&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"kelas",children:"Kelas"}),e.jsxs("select",{id:"kelas",name:"kelas",value:n.kelas,onChange:k,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),e.jsx("option",{value:"1",children:"Kelas 1"}),e.jsx("option",{value:"2",children:"Kelas 2"}),e.jsx("option",{value:"3",children:"Kelas 3"}),e.jsx("option",{value:"4",children:"Kelas 4"}),e.jsx("option",{value:"5",children:"Kelas 5"}),e.jsx("option",{value:"6",children:"Kelas 6"})]})]}),n.role==="4"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"tanggalLahir",children:"Tanggal Lahir"}),e.jsx("input",{type:"date",id:"tanggalLahir",name:"tanggalLahir",value:n.tanggalLahir,onChange:k,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"jenisKelamin",children:"Jenis Kelamin"}),e.jsxs("select",{id:"jenisKelamin",name:"jenisKelamin",value:n.jenisKelamin,onChange:k,required:!0,children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"alamat",children:"Alamat"}),e.jsx("textarea",{id:"alamat",name:"alamat",value:n.alamat,onChange:k,rows:"3",required:n.role==="4"})]}),e.jsx("button",{type:"submit",className:"login-button",disabled:c,children:c?"Sedang Memproses...":"Daftarkan Pengguna"})]}),e.jsx("button",{className:"back-button",onClick:()=>d("/admin/dashboard"),children:"Kembali ke Dashboard Admin"})]})})},te=()=>{var M;const d=W(),[n,o]=b.useState(""),c=a=>/^[0-9+\-\s]{8,20}$/.test(a),j=a=>n?a.filter(t=>{var r,u,g,C,E,A,I,R,H,Z,z,G;const i=n.toLowerCase();switch(l){case"siswa":return((r=t.nama)==null?void 0:r.toLowerCase().includes(i))||((u=t.nis)==null?void 0:u.toLowerCase().includes(i))||((g=t.alamat)==null?void 0:g.toLowerCase().includes(i));case"guru":return((C=t.nama)==null?void 0:C.toLowerCase().includes(i))||((E=t.nuptk)==null?void 0:E.toLowerCase().includes(i))||((A=t.no_telp)==null?void 0:A.includes(n))||((I=t.alamat)==null?void 0:I.toLowerCase().includes(i));case"wali":return((R=t.nama)==null?void 0:R.toLowerCase().includes(i))||((H=t.no_telp)==null?void 0:H.includes(n))||((Z=t.alamat)==null?void 0:Z.toLowerCase().includes(i));case"admin":return((z=t.nama)==null?void 0:z.toLowerCase().includes(i))||((G=t.tipe_admin)==null?void 0:G.toLowerCase().includes(i));default:return!1}}):a,[p,x]=b.useState({siswa:[],guru:[],wali:[],admin:[]}),[N,S]=b.useState([]),[k,K]=b.useState(!0),[l,f]=b.useState("siswa"),[T,w]=b.useState(!1),[y,L]=b.useState(!1),[O,D]=b.useState(null),[s,m]=b.useState({nama:"",nis:"",tanggal_lahir:"",alamat:"",id_kelas:"",id_wali:"",Jenis_Kelamin:"",nuptk:"",no_telp:"",kelas:"",tipe_admin:"",password:"",auth_user_id:null});b.useEffect(()=>{$(),Y()},[]);const $=async()=>{K(!0);try{const[a,t,i,r]=await Promise.all([h.from("siswa").select(`
            *,
            wali:id_wali (
              nama
            )
          `),h.from("guru").select("*"),h.from("wali").select("*"),h.from("admin").select("*")]);if(a.error)throw new Error(`Error fetching siswa: ${a.error.message}`);if(t.error)throw new Error(`Error fetching guru: ${t.error.message}`);if(i.error)throw new Error(`Error fetching wali: ${i.error.message}`);if(r.error)throw new Error(`Error fetching admin: ${r.error.message}`);x({siswa:a.data||[],guru:t.data||[],wali:i.data||[],admin:r.data||[]})}catch(a){console.error("Error fetching users:",a),alert("Error fetching users: "+a.message)}finally{K(!1)}},Y=async()=>{try{const{data:a,error:t}=await h.from("kelas").select("*").order("nama_kelas",{ascending:!0});if(t)throw t;S(a||[])}catch(a){console.error("Error fetching kelas:",a),alert("Error fetching kelas data: "+a.message)}},B=async()=>{try{const{error:a}=await h.auth.signOut();if(a)throw a;localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userRole"),d("/login")}catch(a){console.error("Error logging out:",a),alert("Error logging out. Please try again.")}},P=async(a,t,i)=>{let r="";switch(t){case"siswa":r=`Apakah Anda yakin ingin menghapus siswa "${i.nama}" dengan NIS ${i.nis}?

Peringatan: Tindakan ini akan menghapus semua data terkait siswa termasuk:
- Catatan siswa
- Riwayat kemajuan
- Nilai-nilai`;break;case"guru":r=`Apakah Anda yakin ingin menghapus guru "${i.nama}" dengan NUPTK ${i.nuptk}?

Peringatan: Tindakan ini akan mempengaruhi data kelas yang diajar oleh guru ini.`;break;case"wali":r=`Apakah Anda yakin ingin menghapus wali murid "${i.nama}"?

Peringatan: Pastikan tidak ada siswa yang masih terkait dengan wali ini.`;break;case"admin":r=`Apakah Anda yakin ingin menghapus admin "${i.nama}" (${i.tipe_admin})?`;break;default:r="Apakah Anda yakin ingin menghapus pengguna ini?"}if(window.confirm(r))try{let u,g;if(t==="siswa"){u="siswa",g="id_siswa";const{error:E}=await h.from("siswa_catatan").delete().eq("id_siswa",a);if(E)throw E;const{error:A}=await h.from("kemajuan").delete().eq("id_siswa",a);if(A)throw A;const{error:I}=await h.from("nilai").delete().eq("id_siswa",a);if(I)throw I}else if(t==="guru")u="guru",g="id_guru";else if(t==="wali")u="wali",g="id_wali";else if(t==="admin")u="admin",g="id_admin";else throw new Error("Unknown role");const{error:C}=await h.from(u).delete().eq(g,a);if(C)throw C;alert(`${t.charAt(0).toUpperCase()+t.slice(1)} berhasil dihapus!`),$()}catch(u){console.error("Error deleting user:",u),alert("Error deleting user: "+u.message)}},X=async()=>{try{const a=l;if((l==="guru"||l==="wali")&&!c(s.no_telp))throw new Error("Nomor telepon harus terdiri dari 8-20 karakter dan hanya boleh mengandung angka, tanda plus, strip, dan spasi");let t={...s};switch(l){case"siswa":t={nama:s.nama,nis:s.nis,tanggal_lahir:s.tanggal_lahir,alamat:s.alamat,id_kelas:parseInt(s.id_kelas),id_wali:parseInt(s.id_wali),Jenis_Kelamin:s.Jenis_Kelamin,id_role:4};break;case"guru":t={nama:s.nama,nuptk:s.nuptk,no_telp:s.no_telp,alamat:s.alamat,kelas:s.kelas,id_role:2};break;case"wali":t={nama:s.nama,alamat:s.alamat,no_telp:s.no_telp,id_role:3};break;case"admin":t={nama:s.nama,tipe_admin:s.tipe_admin};break;default:throw new Error("Invalid user type")}let i=null;if(l==="siswa"?i=await h.from(a).select().eq("nis",s.nis).single():l==="guru"&&(i=await h.from(a).select().eq("nuptk",s.nuptk).single()),i!=null&&i.data)throw new Error(`${l} dengan ${l==="siswa"?"NIS":"NUPTK"} tersebut sudah ada`);const{data:r,error:u}=await h.from(a).insert([t]).select();if(u)throw u;x(g=>({...g,[l]:[...g[l],r[0]]})),w(!1),m(U),alert("Pengguna berhasil ditambahkan!"),$()}catch(a){console.error("Error creating user:",a),alert("Error creating user: "+a.message)}},Q=async()=>{try{const a=l;let t,i;if((l==="guru"||l==="wali")&&!c(s.no_telp))throw new Error("Nomor telepon harus terdiri dari 8-20 karakter dan hanya boleh mengandung angka, tanda plus, strip, dan spasi");switch(l){case"siswa":t="id_siswa",i={nama:s.nama,nis:s.nis,tanggal_lahir:s.tanggal_lahir,alamat:s.alamat,id_kelas:parseInt(s.id_kelas),id_wali:parseInt(s.id_wali),Jenis_Kelamin:s.Jenis_Kelamin};break;case"guru":t="id_guru",i={nama:s.nama,nuptk:s.nuptk,no_telp:s.no_telp,alamat:s.alamat,kelas:s.kelas};break;case"wali":t="id_wali",i={nama:s.nama,alamat:s.alamat,no_telp:s.no_telp};break;case"admin":t="id_admin",i={nama:s.nama,tipe_admin:s.tipe_admin};break;default:throw new Error("Invalid user type")}const{error:r}=await h.from(a).update(i).eq(t,O[t]);if(r)throw r;x(u=>({...u,[l]:u[l].map(g=>g[t]===O[t]?{...g,...i}:g)})),w(!1),L(!1),D(null),m(U),alert("Pengguna berhasil diperbarui!"),$()}catch(a){console.error("Error updating user:",a),alert(a.message)}},q=a=>{D(a),m({...a,id_wali:a.id_wali?a.id_wali.toString():"",id_kelas:a.id_kelas?a.id_kelas.toString():"",nama:a.nama||"",nis:a.nis||"",nuptk:a.nuptk||"",tanggal_lahir:a.tanggal_lahir||"",Jenis_Kelamin:a.Jenis_Kelamin||"",alamat:a.alamat||"",no_telp:a.no_telp||"",kelas:a.kelas||"",tipe_admin:a.tipe_admin||""}),L(!0),w(!0)},U={nama:"",nis:"",tanggal_lahir:"",alamat:"",id_kelas:"",id_wali:"",Jenis_Kelamin:"",nuptk:"",no_telp:"",kelas:"",tipe_admin:"",password:"",auth_user_id:null},V=()=>e.jsx("div",{className:`modal ${T?"show":""}`,children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("h2",{children:[y?"Edit":"Tambah"," ",l]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),y?Q():X()},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nama:"}),e.jsx("input",{type:"text",value:s.nama,onChange:a=>m({...s,nama:a.target.value}),required:!0})]}),l==="siswa"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"NIS:"}),e.jsx("input",{type:"text",value:s.nis,onChange:a=>m({...s,nis:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tanggal Lahir:"}),e.jsx("input",{type:"date",value:s.tanggal_lahir,onChange:a=>m({...s,tanggal_lahir:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Alamat:"}),e.jsx("textarea",{value:s.alamat,onChange:a=>m({...s,alamat:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kelas:"}),e.jsxs("select",{value:s.id_kelas,onChange:a=>m({...s,id_kelas:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),N.map(a=>e.jsx("option",{value:a.id_kelas,children:a.nama_kelas},a.id_kelas))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wali:"}),e.jsxs("select",{value:s.id_wali,onChange:a=>m({...s,id_wali:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Wali"}),p.wali.map(a=>e.jsx("option",{value:a.id_wali,children:a.nama},a.id_wali))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jenis Kelamin:"}),e.jsxs("select",{value:s.Jenis_Kelamin,onChange:a=>m({...s,Jenis_Kelamin:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Jenis Kelamin"}),e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]})]}),l==="guru"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"NUPTK:"}),e.jsx("input",{type:"text",value:s.nuptk,onChange:a=>m({...s,nuptk:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"No. Telepon:"}),e.jsx("input",{type:"tel",value:s.no_telp,onChange:a=>m({...s,no_telp:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Alamat:"}),e.jsx("textarea",{value:s.alamat,onChange:a=>m({...s,alamat:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kelas:"}),e.jsxs("select",{value:s.kelas,onChange:a=>m({...s,kelas:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),N.map(a=>e.jsx("option",{value:a.nama_kelas,children:a.nama_kelas},a.id_kelas))]})]})]}),l==="wali"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"No. Telepon:"}),e.jsx("input",{type:"tel",value:s.no_telp,onChange:a=>m({...s,no_telp:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Alamat:"}),e.jsx("textarea",{value:s.alamat,onChange:a=>m({...s,alamat:a.target.value}),required:!0})]})]}),l==="admin"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tipe Admin:"}),e.jsxs("select",{value:s.tipe_admin,onChange:a=>m({...s,tipe_admin:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Tipe Admin"}),e.jsx("option",{value:"super",children:"Super Admin"}),e.jsx("option",{value:"regular",children:"Regular Admin"})]})]})}),!y&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password:"}),e.jsx("input",{type:"password",value:s.password,onChange:a=>m({...s,password:a.target.value}),required:!0})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"submit",children:y?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:()=>{w(!1),L(!1),D(null),m(U)},children:"Batal"})]})]})]})}),ee=()=>{const a=p[l]||[],t=j(a);if(k)return e.jsxs("div",{className:"loading",children:[e.jsx("i",{className:"fas fa-spinner"})," Loading users..."]});const i=()=>{switch(l){case"siswa":return e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"NIS"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Tanggal Lahir"}),e.jsx("th",{children:"Alamat"}),e.jsx("th",{children:"Kelas"}),e.jsx("th",{children:"Wali"}),e.jsx("th",{children:"Jenis Kelamin"}),e.jsx("th",{children:"Avatar"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Updated At"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:t.map(r=>{var u,g;return e.jsxs("tr",{children:[e.jsx("td",{children:r.nis}),e.jsx("td",{children:r.nama}),e.jsx("td",{children:r.tanggal_lahir}),e.jsx("td",{children:r.alamat}),e.jsx("td",{children:((u=N.find(C=>C.id_kelas===r.id_kelas))==null?void 0:u.nama_kelas)||"-"}),e.jsx("td",{children:((g=r.wali)==null?void 0:g.nama)||"-"}),e.jsx("td",{children:r.Jenis_Kelamin}),e.jsx("td",{children:r.avatar?"✓":"✗"}),e.jsx("td",{children:new Date(r.created_at).toLocaleDateString()}),e.jsx("td",{children:new Date(r.updated_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsxs("button",{className:"edit-button",onClick:()=>q(r),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit"]}),e.jsxs("button",{className:"delete-button",onClick:()=>P(r.id_siswa,"siswa",r),children:[e.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Hapus"]})]})]},r.id_siswa)})})]});case"guru":return e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"NUPTK"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"No. Telepon"}),e.jsx("th",{children:"Alamat"}),e.jsx("th",{children:"Kelas"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Updated At"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.nuptk}),e.jsx("td",{children:r.nama}),e.jsx("td",{children:r.no_telp}),e.jsx("td",{children:r.alamat}),e.jsx("td",{children:r.kelas}),e.jsx("td",{children:new Date(r.created_at).toLocaleDateString()}),e.jsx("td",{children:new Date(r.updated_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsxs("button",{className:"edit-button",onClick:()=>q(r),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit"]}),e.jsxs("button",{className:"delete-button",onClick:()=>P(r.id_guru,"guru",r),children:[e.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Hapus"]})]})]},r.id_guru))})]});case"wali":return e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Alamat"}),e.jsx("th",{children:"No. Telepon"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Updated At"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.nama}),e.jsx("td",{children:r.alamat}),e.jsx("td",{children:r.no_telp}),e.jsx("td",{children:new Date(r.created_at).toLocaleDateString()}),e.jsx("td",{children:new Date(r.updated_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsxs("button",{className:"edit-button",onClick:()=>q(r),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit"]}),e.jsxs("button",{className:"delete-button",onClick:()=>P(r.id_wali,"wali",r),children:[e.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Hapus"]})]})]},r.id_wali))})]});case"admin":return e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Tipe Admin"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.nama}),e.jsx("td",{children:r.tipe_admin}),e.jsx("td",{children:new Date(r.created_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsxs("button",{className:"edit-button",onClick:()=>q(r),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit"]}),e.jsxs("button",{className:"delete-button",onClick:()=>P(r.id_admin,"admin",r),children:[e.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Hapus"]})]})]},r.id_admin))})]});default:return e.jsx("div",{className:"no-users",children:"Tab tidak valid"})}};return e.jsxs("div",{className:"users-container",children:[e.jsx("div",{className:"search-filter",children:e.jsx("input",{type:"text",className:"search-input",placeholder:`Cari ${l} berdasarkan nama, ${l==="siswa"?"NIS, atau alamat":l==="guru"?"NUPTK, nomor telepon, atau alamat":l==="wali"?"nomor telepon atau alamat":"tipe admin"}...`,value:n,onChange:r=>o(r.target.value)})}),e.jsx("div",{className:"table-actions",children:e.jsxs("button",{onClick:()=>{L(!1),D(null),m(U),w(!0)},children:[e.jsx("i",{className:"fas fa-plus-circle mr-2"}),"Tambah ",l]})}),t.length===0?e.jsxs("div",{className:"no-users",children:["Tidak ada pengguna ",l," yang ditemukan."]}):e.jsx("div",{className:"table-wrapper",children:i()})]})};return e.jsxs("div",{className:"admin-dashboard",children:[e.jsxs("div",{className:"dashboard-container",children:[e.jsx("h1",{children:"Dashboard Admin"}),e.jsx("div",{className:"admin-actions",children:e.jsxs("button",{className:"logout-button",onClick:B,children:[e.jsx("i",{className:"fas fa-sign-out-alt"}),"Logout"]})}),e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${l==="siswa"?"active":""}`,onClick:()=>f("siswa"),children:[e.jsx("i",{className:"fas fa-user-graduate mr-2"}),"Siswa (",p.siswa.length,")"]}),e.jsxs("button",{className:`tab ${l==="guru"?"active":""}`,onClick:()=>f("guru"),children:[e.jsx("i",{className:"fas fa-chalkboard-teacher mr-2"}),"Guru (",p.guru.length,")"]}),e.jsxs("button",{className:`tab ${l==="wali"?"active":""}`,onClick:()=>f("wali"),children:[e.jsx("i",{className:"fas fa-users mr-2"}),"Orang Tua (",p.wali.length,")"]}),e.jsxs("button",{className:`tab ${l==="admin"?"active":""}`,onClick:()=>f("admin"),children:[e.jsx("i",{className:"fas fa-user-shield mr-2"}),"Admin (",((M=p.admin)==null?void 0:M.length)||0,")"]})]}),e.jsx("div",{className:"users-container",children:ee()})]}),V()]})};export{re as A,te as D,h as s};
